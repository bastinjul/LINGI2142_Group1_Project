<%# ERB template https://puppet.com/docs/puppet/5.3/lang_template_erb.html -%>
router id <%= @routing_id %>;

protocol kernel {
 	learn;
	scan time 20;
	export all;
}

protocol device {
	scan time 10;
}

protocol ospf {

	area 0.0.0.0 {
		<%- @ospfv3["hello_itfs"].each do |val| -%>
			interface "<%= val %>" {
				hello 1;
				dead 3;
			};
		<%- end -%>
		<%- @ospfv3["stub_itfs"].each do |val| -%>
			interface "<%= val %>" {
				stub 1;
			};
		<%- end -%>
    };
}

<%- if @bgp["isBorderRouter"] == true -%>
	
	protocol static static_bgp{
		route <%= @bgp["export_prefix"] %> reject;
	}

	protocol bgp provider {
		local as <%= @bgp["local_as"] %>;
		neighbor <%= @bgp["neighbor_ip"] %> as <%= @bgp["neighbor_as"]%>;
		#source address <%= @bgp["source_ip"] %>;
		export where proto = "static_bgp";
		import all;
	}
<%- end -%>
